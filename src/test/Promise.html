<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Title</title>
</head>
<body>

<script type="text/javascript">
//  function fetch() {
//    axios.get('/user?ID=12345')
//      .then(function (response) {
//        console.log(response);
//      })
//      .catch(function (error) {
//        console.log(error);
//      });
//  };
  // 然后在需要它的地方调用它
//  async function getUserInfo() {
//    const info = await fetch();
//
//    return info;
//  }
//  getUserInfo().then(info => console.log(info));



  async function async1(){
    console.log('async1 start')
    await async2()
    console.log('async1 end')
  }
  async function async2(){
    console.log('async2')
  }
  console.log('script start')
  setTimeout(function(){
    console.log('setTimeout')
  },0)
  async1();
  new Promise(function(resolve){
    console.log('promise1')
    resolve();
  }).then(function(){
    console.log('promise2')
  })
  console.log('script end')

  //当调用一个 async 函数时，会返回一个 Promise 对象。当这个 async 函数返回一个值时，Promise 的 resolve 方法会负责传递这个值；当 async 函数抛出异常时，Promise 的 reject 方法也会传递这个异常值。
//  async 函数中可能会有 await 表达式，这会使 async 函数暂停执行，等待 Promise  的结果出来，然后恢复async函数的执行并返回解析值（resolved）。
//  async/await的用途是简化使用 promises 异步调用的操作，并对一组 Promises执行某些操作。正如Promises类似于结构化回调，async/await类似于组合生成器和 promises。
//  await
//  await  操作符用于等待一个Promise 对象。它只能在异步函数 async function 中使用
/*await 表达式会暂停当前 async function 的执行，等待 Promise 处理完成。若 Promise 正常处理(fulfilled)，其回调的resolve函数参数作为 await 表达式的值，继续执行 async function。
 若 Promise 处理异常(rejected)，await 表达式会把 Promise 的异常原因抛出。
 另外，如果 await 操作符后的表达式的值不是一个 Promise，则返回该值本身。
*/
/*定义一个异步函数 async1
 定义一个异步函数 async2
 打印 ‘script start’ // *1
 定义一个定时器（宏任务，优先级低于微任务），在0ms 之后输出
 执行异步函数 async1
 打印 'async1 start' // *2
 遇到await 表达式，执行 await 后面的 async2
 打印 'async2' // *3
 返回一个 Promise，跳出 async1 函数体
 执行 new Promise 里的语句
 打印 ‘promise1‘	// *4
 resolve() , 返回一个 Promise 对象，把这个 Promise 压进队列里
 打印 ’script end'  // *5
 同步栈执行完毕
 回到 async1 的函数体，async2 函数没有返回 Promise，所以把要等async2 的值 resolve，把 Promise 压进队列
 执行 new Promise 后面的 .then，打印 ’promise2‘ // *6
 回到 async1 的函数体，await 返回 Promise.resolve() ，然后打印后面的 ’async1 end‘  // *7
 最后执行定时器（宏任务） setTimeout，打印 ’setTimeout‘ // *8
*/

//  async function async1(){
//    console.log('async1 start')
//    await async2()
//    console.log('async1 end')
//  }
//  function async2(){ // 去掉了 async 关键字
//    console.log('async2');
//  }
//  console.log('script start')
//  setTimeout(function(){
//    console.log('setTimeout')
//  },0)
//  async1();
//  new Promise(function(resolve){
//    console.log('promise1')
//    resolve();
//  }).then(function(){
//    console.log('promise2')
//  })
//  console.log('script end')
</script>
</body>
</html>